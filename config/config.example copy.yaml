# VYA BackupDB Configuration Example
# Copy this file to config.yaml and customize for your environment
#
# IMPORTANT: This file contains ONLY configuration settings.
# Credentials (username/password) are stored separately in .secrets/vault.json.enc
# Use 'vya-backupdb vault-add' to manage credentials securely.
#
# Quick Start:
# 1. Add credentials to vault:
#    vya-backupdb vault-add --id mysql-prod --username root --password <pass>
# 2. Copy this file: cp config.example.yaml config.yaml
# 3. Edit config.yaml with your host/port/database filters
# 4. Run backup: vya-backupdb backup --instance prod-mysql-01

application_name: vya-backupdb
version: "2.0.0"
environment: production  # Options: dev, staging, production

# Database Instances
# Credentials are stored in .secrets/vault.json.enc
# Use 'vya-backupdb vault-add' to manage credentials
databases:
  # Example 1: MySQL - Backup all databases except system databases
  - id: prod-mysql-01
    type: mysql
    host: localhost
    port: 3306
    enabled: true
    credential_name: mysql-prod  # Reference to vault credential ID
    
    # Database filtering (optional)
    database: []  # Empty = all databases (default)
    db_ignore:    # Exclude these databases
      - information_schema
      - performance_schema
      - mysql
      - sys
    
    ssl_enabled: false
    # ssl_ca_cert: /path/to/ca-cert.pem  # Optional: SSL certificate path

  # Example 2: PostgreSQL - Backup all databases except system databases
  - id: prod-postgres-01
    type: postgresql
    host: localhost
    port: 5432
    enabled: true
    credential_name: postgresql-prod  # Reference to vault credential ID
    
    # Database filtering (optional)
    database: []  # Empty = all databases
    db_ignore:    # Exclude these databases
      - postgres
      - template0
      - template1
    
    ssl_enabled: false

  # Example 3: MySQL - Backup only specific databases (whitelist)
  - id: prod-mysql-specific
    type: mysql
    host: mysql-app.example.com
    port: 3306
    enabled: false
    credential_name: mysql-prod  # Same credential, different filters
    
    # Whitelist: backup ONLY these databases
    database:
      - app_production
      - app_analytics
    db_ignore: []  # No blacklist when using whitelist
    
    ssl_enabled: true
    ssl_ca_cert: /etc/ssl/certs/mysql-ca.pem

  # Example 4: PostgreSQL with SSL
  - id: prod-postgres-ssl
    type: postgresql
    host: postgres.example.com
    port: 5432
    enabled: false
    credential_name: postgresql-prod
    
    database: []  # All databases
    db_ignore:
      - test_db
      - staging_db
    
    ssl_enabled: true
    ssl_ca_cert: /etc/ssl/certs/postgres-ca.pem

# Storage Configuration
storage:
  base_path: /var/backups/vya_backupdb
  structure: "{hostname}/{db_id}/{db_name}/{date}"
  compression_level: 6  # 1-9 (1=fastest, 9=best compression)
  checksum_algorithm: sha256  # Options: md5, sha256

# Retention Policy
retention:
  strategy: gfs  # Options: simple, gfs
  daily_keep: 7
  weekly_keep: 4
  monthly_keep: 12
  cleanup_enabled: true

# Logging Configuration
logging:
  level: INFO  # Options: DEBUG, INFO, WARNING, ERROR
  format: json  # Options: json, text
  output: file  # Options: console, file, both
  file_path: /var/log/vya_backupdb/app.log
