# üî¥ COPILOT STRICT EXECUTION RULES - CRITICAL & MANDATORY

**Last Updated:** 2025-11-26
**Status:** ACTIVE - ALL SESSIONS
**Priority:** P0 - CRITICAL
**Enforcement:** 100% MANDATORY - NO EXCEPTIONS

---

## üî¥ ABSOLUTE PROHIBITION: cat/echo/EOF/HEREDOC Pattern

### ‚ö†Ô∏è CRITICAL UPDATE: ALL OPERATIONS MUST USE 3-STEP WORKFLOW

**GITHUB COPILOT HAS FULL FILE MANIPULATION PERMISSIONS - THERE IS NO REASON TO USE HEREDOC**

**IMPORTANT:** Scripts shell, resumos, relat√≥rios, apresenta√ß√µes de resultados e **QUALQUER** opera√ß√£o com arquivos **NUNCA** devem usar `cat <<EOF`, `cat <<'EOF'`, `cat <<HEREDOC`, ou QUALQUER varia√ß√£o de here document.

### üö´ PROIBIDO EM 100% DAS SITUA√á√ïES:
- ‚ùå `cat <<EOF` (heredoc padr√£o)
- ‚ùå `cat <<'EOF'` (heredoc com quotes)
- ‚ùå `cat > file <<EOF` (heredoc com redirecionamento)
- ‚ùå `cat << HEREDOC` (qualquer nome de delimitador)
- ‚ùå `<<-EOF` (heredoc com tab stripping)
- ‚ùå TODAS as varia√ß√µes de here document

Use o padr√£o obrigat√≥rio: **create_file ‚Üí cat ‚Üí rm (3 PASSOS SEMPRE)**

### THE FORBIDDEN PATTERN (NEVER EVER USE - ZERO TOLERANCE):
```bash
# ‚ùå FORBIDDEN - Using echo with cat piping
echo "content" | cat

# ‚ùå FORBIDDEN - Using heredoc (cat << EOF) - EM QUALQUER SITUA√á√ÉO
cat <<EOF
content here
EOF

# ‚ùå FORBIDDEN - Using heredoc with quotes
cat <<'EOF'
content here
EOF

# ‚ùå FORBIDDEN - Using heredoc with redirection
cat > file <<EOF
content
EOF

# ‚ùå FORBIDDEN - Using heredoc in shell scripts
#!/bin/bash
cat > file <<'YAML_END'
content
YAML_END

# ‚ùå FORBIDDEN - Inline echo and cat combination
echo "text" > file && cat file

# ‚ùå FORBIDDEN - Using printf with piping
printf "data\n" | cat

# ‚ùå FORBIDDEN - Using tee with cat
echo "content" | tee file | cat

# ‚ùå FORBIDDEN - All variations of heredoc (ANY delimiter name)
cat << HEREDOC
...
HEREDOC

cat <<-EOF  # Tab stripping heredoc
...
EOF

cat <<"DELIMITER"  # Quoted delimiter
...
DELIMITER

# ‚ùå FORBIDDEN - Any inline file creation without create_file tool

# ‚ùå FORBIDDEN - Presentations/summaries with cat <<EOF
# (Isso inclui sum√°rios visuais, relat√≥rios finais, output formatado)

# ‚ùå FORBIDDEN - Shell scripts creating files with heredoc
# (Scripts DEVEM usar create_file tool, N√ÉO heredoc interno)
```

---

## ‚úÖ THE ONLY CORRECT PATTERN (100% MANDATORY)

### THREE-STEP WORKFLOW (ZERO EXCEPTIONS):

**STEP 1: CREATE FILE**
```
Use the create_file tool with complete content
Example: create_file /path/to/file.txt "Complete file content here"
```

**STEP 2: DISPLAY FILE**
```
Use cat command in terminal OR read_file tool
Example: cat /path/to/file.txt
```

**STEP 3: CLEANUP (IF TEMPORARY)**
```
Use run_in_terminal with rm command
Example: run_in_terminal "rm /path/to/file.txt"
```

---

## üéØ WORKING EXAMPLES

### Example 1: Create & Display Ansible Inventory

**CORRECT FILE LOCATION:** `ansible/inventory/hosts.yml` (NOT `hosts.ini`)

```bash
# ‚úÖ CORRECT - Use create_file tool with full content
create_file /tmp/inventory_example.yml "---
all:
  hosts:
    dsmaster01:
      ansible_host: 192.168.1.10
      kubernetes_role: master-primary
    dsmaster02:
      ansible_host: 192.168.1.11
      kubernetes_role: master-secondary
    dsworker01:
      ansible_host: 192.168.1.20
      kubernetes_role: worker
    dsworker02:
      ansible_host: 192.168.1.21
      kubernetes_role: worker
  vars:
    ansible_user: root
    ansible_become: yes"

# ‚úÖ Display with cat via run_in_terminal
run_in_terminal "cat /tmp/inventory_example.yml"

# ‚úÖ Cleanup temporary file
run_in_terminal "rm /tmp/inventory_example.yml"
```

### Example 2: Create & Display Configuration
```bash
# ‚úÖ CORRECT - Use create_file tool
create_file /tmp/config.yaml "apiVersion: v1
kind: Config
clusters:
  - name: test"

# ‚úÖ Display with cat
run_in_terminal "cat /tmp/config.yaml"

# ‚úÖ Cleanup
run_in_terminal "rm /tmp/config.yaml"
```

### Example 2: Create Python Script
```bash
# ‚úÖ CORRECT - Use create_file tool
create_file /tmp/script.py "#!/usr/bin/env python3
import sys
print('Hello World')"

# ‚úÖ Execute and display
run_in_terminal "python3 /tmp/script.py && cat /tmp/script.py"

# ‚úÖ Cleanup
run_in_terminal "rm /tmp/script.py"
```

### Example 3: Multi-line YAML/JSON
```bash
# ‚úÖ CORRECT - Use create_file with proper formatting
create_file /tmp/deploy.yaml "apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx"

# ‚úÖ Verify
run_in_terminal "cat /tmp/deploy.yaml"

# ‚úÖ Cleanup
run_in_terminal "rm /tmp/deploy.yaml"
```

---

## üö® WHY THIS RULE IS ABSOLUTE

### Technical Reasons (CAN'T BE VIOLATED):
1. ‚úÖ Copilot has **FULL** file manipulation permissions - no need for workarounds
2. ‚úÖ create_file tool works with ALL file types (yaml, json, sh, py, conf, txt, md, etc)
3. ‚úÖ Enables proper CI/CD integration without shell interpretation issues
4. ‚úÖ Supports special characters and escaping automatically
5. ‚úÖ Creates audit trail for all file operations
6. ‚úÖ Works reliably across all platforms and shells

### Enforcement Reasons (MUST BE ENFORCED):
1. ‚úÖ Consistency across entire project (no mixed patterns)
2. ‚úÖ Reproducibility in automated deployments
3. ‚úÖ Professional standards compliance
4. ‚úÖ Security: No shell injection risks
5. ‚úÖ Debugging: Clear file creation history
6. ‚úÖ Maintainability: Easy to track what was created/modified

---

## üìã MANDATORY CHECKLIST (BEFORE EVERY OPERATION)

For ANY task that creates or displays files:

- [ ] Did I use `create_file` tool to create the file?
- [ ] Did I use `cat` command OR `read_file` tool to display?
- [ ] Did I clean up temporary files with `rm`?
- [ ] Is the content in the tool call, NOT in shell commands?
- [ ] Would this approach work in CI/CD without shell workarounds?

**If ANY checkbox is false ‚Üí STOP and redo using correct pattern**

---

## üéØ APPLICABLE TO (NO EXCEPTIONS):

- ‚úÖ Configuration files (YAML, JSON, CONF, ENV, INI)
- ‚úÖ Documentation files (MD, TXT, RST, ADOC)
- ‚úÖ Shell scripts (SH, BASH, ZSH)
- ‚úÖ Python files (PY, PYENV)
- ‚úÖ Ansible playbooks and roles
- ‚úÖ Kubernetes manifests (YAML)
- ‚úÖ Terraform files (TF)
- ‚úÖ Docker files (Dockerfile, compose)
- ‚úÖ Any content that needs to be saved/versioned
- ‚úÖ Any output that should be logged/tracked
- ‚úÖ Temporary display files (create ‚Üí display ‚Üí delete)
- ‚úÖ **EVERY SINGLE TIME** you would use `echo`, `printf`, `cat << EOF`, heredoc, or shell piping

---

## üîç DETECTION & ENFORCEMENT

### Signs That Pattern Was VIOLATED:
1. Code contains `cat <<EOF` or `cat << HEREDOC`
2. Code contains `echo "..." | cat`
3. Code contains `printf "..." | tee`
4. Code uses heredoc syntax with `< <()`
5. Multiple shell commands piped for file creation
6. No `create_file` tool call before file content

### Consequence of Violation:
- ‚ùå Break CI/CD pipelines
- ‚ùå Fail in automated deployments
- ‚ùå Create hard-to-debug issues
- ‚ùå Violate project standards
- ‚ùå Risk of special character corruption

---

## ÔøΩ CRITICAL RULE ADDITION: PRESENTATIONS & FINAL SUMMARIES

### ‚ö†Ô∏è RESUMOS FINAIS E APRESENTA√á√ïES **NUNCA** USEM `cat <<EOF`

**ESTA REGRA √â ABSOLUTA E APLICA-SE A 100% DAS SITUA√á√ïES**

Todas as apresenta√ß√µes de resultados, sum√°rios e relat√≥rios **DEVEM OBRIGATORIAMENTE** usar o padr√£o de 3 passos.

**GitHub Copilot tem PERMISS√ÉO TOTAL para manipular arquivos - N√ÉO H√Å RAZ√ÉO para usar heredoc**

### ‚ùå PROIBIDO ABSOLUTAMENTE (NUNCA FA√áA - ZERO EXCE√á√ïES)
```bash
# ‚ùå Apresenta√ß√£o de resultado PROIBIDA
cat <<EOF

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë        DEPLOYMENT COMPLETE             ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

EOF

# ‚ùå TAMB√âM PROIBIDO - Qualquer varia√ß√£o
cat << HEREDOC- PADR√ÉO OBRIGAT√ìRIO (100% DAS VEZES)
```bash
# PASSO 1: Criar arquivo com conte√∫do usando create_file tool
create_file /tmp/final_summary.txt "

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë        DEPLOYMENT COMPLETE             ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

Status: SUCCESS
Tasks: 7/7 Completed
Duration: 2.5 hours
"

# PASSO 2: Exibir com cat command
run_in_terminal "cat /tmp/final_summary.txt"

# PASSO 3: Limpar arquivo tempor√°rio (OBRIGAT√ìRIO)
run_in_terminal "rm -f /tmp/final_summary.txt"
```

**POR QUE ESTEOBRIGATORIAMENTE a:
- ‚úÖ Sum√°rios finais de sess√£o
- ‚úÖ Relat√≥rios de status
- ‚úÖ Tabelas de resultados
- ‚úÖ Apresenta√ß√µes formatadas
- ‚úÖ Boxed messages com caracteres especiais
- ‚úÖ Qualquer output visual para o usu√°rio
- ‚úÖ Resumos de execu√ß√£o de playbooks
- ‚úÖ Apresenta√ß√µes de conclus√£o de tarefas
- ‚úÖ Documenta√ß√£o inline durante opera√ß√µes
- ‚úÖ Logs formatados para exibi√ß√£o
- ‚úÖ **TODA E QUALQUER exibi√ß√£o de conte√∫do formatado**

### üö´ ZERO EXCE√á√ïES - ZERO TOLER√ÇNCIA

**N√ÉO EXISTE** situa√ß√£o que justifique usar `cat <<EOF`:
- ‚ùå "Mas √© s√≥ uma vez" ‚Üí N√ÉO, use create_file
- ‚ùå "√â muito texto" ‚Üí N√ÉO, create_file suporta qualquer tamanho
- ‚ùå "Tem caracteres especiais" ‚Üí N√ÉO, create_file escapa automaticamente
- ‚ùå "√â tempor√°rio" ‚Üí N√ÉO, use create_file ‚Üí cat ‚Üí rm
- ‚ùå "√â para usu√°rio ver" ‚Üí N√ÉO, use create_file ‚Üí cat ‚Üí rm
- ‚ùå **NENHUMA DESCULPA √â V√ÅLIDA**
# PASSO 1: Criar arquivo com conte√∫do
create_file /tmp/final_summary.txt "

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë        DEPLOYMENT COMPLETE             ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

Status: SUCCESS
Tasks: 7/7 Completed
Duration: 2.5 hours
"

# PASSO 2: Exibir com cat
run_in_terminal "cat /tmp/final_summary.txt"

# PASSO 3: Limpar arquivo tempor√°rio
run_in_terminal "rm -f /tmp/final_summary.txt"
```

### Aplica-se a:
- ‚úÖ Sum√°rios finais de sess√£o
- ‚úÖ Relat√≥rios de status
- ‚úÖ Tabelas de resultados
- ‚úÖ Apresenta√ß√µes formatadas
- ‚úÖ Boxed messages com caracteres especiais
- ‚úÖ Qualquer output visual para o usu√°rio

---

## ‚úÖ EXEMPLO PR√ÅTICO: Sum√°rio de Deployment

**ARQUIVO CORRETO PARA INVENT√ÅRIO:** `ansible/inventory/hosts.yml`

```bash
# PASSO 1: Criar arquivo com sum√°rio
create_file /tmp/deployment_summary.txt "
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                                ‚ïë
‚ïë               ‚úÖ DEPLOYMENT COMPLETE                           ‚ïë
‚ïë                                                                ‚ïë
‚ïë                   Enterprise Kubernetes Cluster               ‚ïë
‚ïë                 üöÄ MVP READY FOR PRODUCTION                    ‚ïë
‚ïë                                                                ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìä SUMMARY

  Tasks Completed:        7/7 ‚úÖ
  Documentation Created:  9 files (3,480+ lines)
  Code Improvements:      3 files (29 lines added)
  Git Commit:             ‚úÖ 65571b3 (Success)
  Working Tree:           ‚úÖ CLEAN

üìç CLUSTER CONFIGURATION

  Masters:
    - dsmaster01 (192.168.1.10) - master-primary
    - dsmaster02 (192.168.1.11) - master-secondary

  Workers:
    - dsworker01 (192.168.1.20) - worker
    - dsworker02 (192.168.1.21) - worker

  Kubernetes: v1.32.9
  Container Runtime: containerd 1.7
  CNI: Calico 3.31.0

‚úÖ All Tests Passed

  Playbook Syntax:   ‚úÖ 100% (23/23)
  Role Idempotency:  ‚úÖ 99% (27/27)
  Connectivity:      ‚úÖ All 4 hosts reachable
  Documentation:     ‚úÖ Complete (3,480+ lines)

üöÄ Status: READY FOR DEPLOYMENT

  Inventory File:    ansible/inventory/hosts.yml
  Next Step:         Run pre-deployment checklist
  Estimated Time:    65-75 minutes deployment

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
"

# PASSO 2: Exibir para o usu√°rio
run_in_terminal "cat /tmp/deployment_summary.txt"

# PASSO 3: Limpar arquivo tempor√°rio
run_in_terminal "rm -f /tmp/deployment_summary.txt"
```

---

## üéØ DOCUMENTO DE REFER√äNCIA

Arquivo correto para invent√°rio Ansible:
- ‚úÖ **CORRETO:** `ansible/inventory/hosts.yml` (YAML format)
- ‚ùå **ANTIGO:** `ansible/inventory/hosts.ini` (INI format - descontinuado)

Sempre use o arquivo YAML que tem as configura√ß√µes corretas com IPs reais.

| Action | Tool | Status | Example |
|--------|------|--------|---------|
| Create file | `create_file` | ‚úÖ CORRECT | `create_file /path/file "content"` |
| Create temp file | `create_file` | ‚úÖ CORRECT | `create_file /tmp/file "content"` |
| Display file | `cat` in terminal | ‚úÖ CORRECT | `run_in_terminal "cat /path/file"` |
| Display file | `read_file` tool | ‚úÖ CORRECT | `read_file /path/file 1 100` |
| Delete temp file | `rm` in terminal | ‚úÖ CORRECT | `run_in_terminal "rm /tmp/file"` |
| Edit existing file | `replace_string_in_file` | ‚úÖ CORRECT | See replace_string_in_file tool |
| ‚ùå Create with echo | `echo > file` | ‚ùå FORBIDDEN | NEVER USE |
| ‚ùå Create with heredoc | `cat <<EOF` | ‚ùå FORBIDDEN | NEVER USE |
| ‚ùå Create with printf | `printf \| cat` | ‚ùå FORBIDDEN | NEVER USE |
| ‚ùå Create with tee | `echo \| tee` | ‚ùå FORBIDDEN | NEVER USE |

---

## üéì TRAINING SEQUENCE (IF VIOLATED)

If this rule is violated:
1. ‚ö†Ô∏è STOP execution immediately
2. üìñ Review this entire document
3. üîß Redo the operation using correct pattern (create_file ‚Üí display ‚Üí cleanup)
4. ‚úÖ Verify the result is identical

---

## üìû WHEN IN DOUBT

**Question:** "Should I use create_file or echo/cat?"
**Answer:** **ALWAYS use create_file** - it's simpler, faster, and more reliable

**Question:** "What if the file is temporary?"
**Answer:** Use create_file ‚Üí display ‚Üí delete with rm. Same 3-step pattern.

**Question:** "What if I need to add content to existing file?"
**Answer:** Use replace_string_in_file tool, NOT cat/echo

**Question:** "What about inline commands?"
**Answer:** NO inline shell creation. Always: create_file ‚Üí run_in_terminal ‚Üí cleanup

---

## ‚è±Ô∏è IMPLEMENTATION STATUS

**Version:** 2.0 (Enforced)
**Date:** 2025-11-26
**Scope:** ALL GitHub Copilot sessions in this project
**Enforcement Level:** 100% MANDATORY

---

**üìå THIS IS A PROJECT-WIDE CRITICAL RULE**
**üö´ ZERO TOLERANCE FOR VIOLATIONS**
**‚úÖ REQUIRED FOR ALL FILE OPERATIONS**
